name: Node tests
description: Run tests for Node.js projects 

runs:
  using: composite
  steps:
  - name: Setup Node.js env
    uses: actions/setup-node@main
    with:
      node-version: ${{ matrix.node-version }}
      cache: 'yarn'

  - name: Install yarn
    uses: borales/actions-yarn@v4
    with:
      cmd: install

  - name: Install dependencies
    shell: bash
    run: rm -rf node_modules && yarn install --frozen-lockfile

  - name: Run code checkers
    shell: bash
    run: |
      yarn lint:check
      yarn format:check

  - name: Execute tests
    shell: bash
    run: |
      yarn test
      yarn test:e2e

  - name: Test build
    shell: bash
    run: yarn build
